# CodMate 中文化实施计划

> 创建日期：2025-11-03
> 版本：1.0

## 📋 项目概述

CodMate 是一个 macOS SwiftUI 应用，用于管理本地 AI 代理 CLI 会话。本项目旨在为应用提供完整的中文本地化支持。

## 🎯 目标

- ✅ 提供完整的中文界面
- ✅ 保持术语一致性
- ✅ 优化中文用户的使用体验
- ✅ 支持中文日期、时间、货币等本地化格式

## 📊 工作量评估

| 阶段 | 内容 | 预估工时 | 优先级 |
|------|------|----------|--------|
| 1 | 准备工作（术语表、文件结构） | 0.5 天 | ✅ 完成 |
| 2 | 核心 UI 本地化（主界面、设置） | 2 天 | 🔥 高 |
| 3 | 会话管理相关界面 | 1.5 天 | 🔥 高 |
| 4 | 错误消息和帮助文本 | 0.5 天 | 🟡 中 |
| 5 | 测试和优化 | 0.5 天 | 🟡 中 |

**总预估工时：~5 天（全职投入）**

## 📁 文件结构

```
localization/
└── zh-Hans/
    ├── Localizable.strings              # 主要本地化文件
    ├── Localizable.stringsdict          # 复数形式支持（后续添加）
    ├── 术语表.md                         # 术语翻译规范
    ├── 中文化实施计划.md                  # 本文档
    ├── Models/                           # 数据模型相关
    │   ├── SessionSummary.strings        # 会话摘要
    │   ├── Project.strings              # 项目相关
    │   └── 其他模型...
    ├── Views/                           # 视图界面
    │   ├── ContentView.strings          # 主界面
    │   ├── SettingsView.strings         # 设置页面
    │   ├── SessionList.strings          # 会话列表
    │   └── 其他视图...
    └── Services/                        # 服务层
        ├── SessionActions.strings       # 会话操作
        ├── Terminal.strings             # 终端相关
        └── 其他服务...
```

## 🏗️ 实施步骤

### 阶段 1：准备工作 ✅

- [x] 创建本地化目录结构
- [x] 建立术语翻译规范
- [x] 创建基础 Localizable.strings 文件
- [x] 制定实施计划

### 阶段 2：核心 UI 本地化（进行中 🔥）

#### 2.1 主要界面文件
- [ ] **ContentView.swift** - 主界面
  - 导航栏
  - 侧边栏
  - 详情栏
  - 工具栏
  - 菜单

- [ ] **SettingsView.swift** - 设置页面
  - 通用设置
  - 终端设置
  - 命令设置
  - Codex 设置
  - 关于页面

#### 2.2 技术实现
```swift
// 从：
Text("Settings")
Text("Delete")

// 改为：
Text("settings.title")
Text("actions.delete")
```

### 阶段 3：会话管理相关界面

#### 3.1 会话列表和详情
- [ ] **SessionListView** - 会话列表视图
- [ ] **SessionDetailView** - 会话详情视图
- [ ] **SessionNavigationView** - 会话导航
- [ ] **ConversationTimelineView** - 对话时间线

#### 3.2 会话操作
- [ ] **Resume 操作** - 继续执行
- [ ] **Delete 操作** - 删除
- [ ] **Export 操作** - 导出
- [ ] **New Session** - 新建会话

### 阶段 4：辅助功能和消息

#### 4.1 错误消息和警告
- [ ] 操作失败提示
- [ ] 网络错误信息
- [ ] 文件访问错误
- [ ] 权限错误

#### 4.2 帮助文本和提示
- [ ] 工具提示（Tooltips）
- [ ] 占位符文本
- [ ] 帮助说明文字
- [ ] 空状态提示

### 阶段 5：测试和优化

#### 5.1 功能测试
- [ ] 所有界面显示正常
- [ ] 动态文本长度适配
- [ ] 字体渲染效果
- [ ] 文本截断处理

#### 5.2 性能优化
- [ ] 本地化文件加载性能
- [ ] 字符串插值性能
- [ ] 内存使用优化

## 📝 技术规范

### 1. 字符串命名约定

```swift
// 命名规则：{页面或功能}.{具体元素}
settings.title
settings.general
settings.terminal
actions.delete
actions.save
actions.cancel
actions.resume
session.list
session.detail
error.network
error.permission
tooltip.refresh
placeholder.search
```

### 2. 格式化字符串

```swift
// 参数化字符串
"Open in \(app)" → "在 \(app) 中打开"
"Session count: \(count)" → "会话数：\(count)"

// 支持复数
// 需要使用 Localizable.stringsdict
```

### 3. 日期和时间本地化

```swift
// 使用系统本地化
DateFormatter()
  .locale(Locale(identifier: "zh-Hans"))

// 或使用 SwiftUI 的格式化
Text(date, style: .date)
Text(date, style: .time)
```

## 🚧 技术挑战

### 1. 文本长度变化
- **问题**：中文通常比英文短
- **解决方案**：检查 UI 布局，预留足够空间

### 2. 字体渲染
- **问题**：中文需要特定字体
- **解决方案**：项目已配置 CJK 字体（ContentView.swift:24-28）

### 3. 术语一致性
- **问题**：不同模块使用相同术语
- **解决方案**：使用统一的术语表，代码审查时检查

## 📦 集成到项目

### 1. 添加本地化文件

```bash
# 在 Xcode 中：
# 1. 创建 Localizable.strings 文件
# 2. 添加 zh-Hans 本地化
# 3. 将中文化内容复制到对应文件
```

### 2. 修改代码

```swift
// 替换硬编码字符串
- Text("Settings")
+ Text("settings.title")

- Label("Delete", systemImage: "trash")
+ Label("actions.delete", systemImage: "trash")
```

### 3. 测试和验证

```bash
# 测试不同语言环境
# 切换系统语言为中文
# 检查所有界面显示
```

## ✅ 验收标准

1. **界面完整性** - 所有英文文本都被翻译
2. **术语一致性** - 相同术语在所有位置翻译一致
3. **布局正确** - 中文文本显示无截断或重叠
4. **字体正确** - 使用指定的 CJK 字体渲染
5. **功能正常** - 所有本地化后的功能正常工作

## 📚 参考资源

- [Swift 本地化指南](https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPInternational/BPInternational.html)
- [Xcode 本地化工作流](https://developer.apple.com/localization/)
- [本地化最佳实践](https://developer.apple.com/documentation/swiftui/localization)

## 🔗 相关文件

- [术语表](./术语表.md) - 详细的技术术语翻译
- [Localizable.strings](./Localizable.strings) - 基础字符串本地化文件

---

## 📝 进度追踪

| 日期 | 完成内容 | 下一步 |
|------|----------|--------|
| 2025-11-03 | 创建项目结构、术语表、基础文件 | 开始核心 UI 本地化 |
|  |  |  |
|  |  |  |

---

**注意**：此计划会根据实际实施情况进行调整
